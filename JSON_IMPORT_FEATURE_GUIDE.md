# JSON文件导入功能使用指南

## 功能概述
已成功添加JSON文件导入功能，用户可以选择外部JSON文件来导入URL链接，支持替换和追加两种模式。

## 新增功能

### 🎯 导入JSON文件
- **位置**：URL管理界面底部操作按钮区域
- **按钮**：`导入JSON文件`（左侧）和`保存到文件`（右侧）
- **功能**：选择外部JSON文件并导入URL链接

### 📋 导入选项
1. **替换模式**：清空当前所有链接，导入新链接
2. **追加模式**：保留现有链接，添加新链接（自动去重）
3. **取消操作**：放弃导入

## 使用方法

### 1. 准备JSON文件
确保JSON文件格式正确：
```json
[
  {
    "title": "链接标题",
    "url": "链接地址",
    "timestamp": 时间戳
  },
  {
    "title": "得物深度链接",
    "url": "dewulink://m.dewu.com/note?routerUrl=...",
    "timestamp": 1703123456789
  }
]
```

### 2. 导入操作
1. 打开应用，进入"管理链接"界面
2. 点击底部的"导入JSON文件"按钮
3. 在文件选择器中选择JSON文件
4. 系统会显示导入确认对话框
5. 选择导入模式：
   - **替换**：替换所有现有链接
   - **追加**：追加新链接（去重）
   - **取消**：放弃导入

### 3. 导入结果
- 成功导入会显示导入的链接数量
- 追加模式会显示实际添加的新链接数量
- 重复链接会被自动过滤

## 技术实现

### 🔧 核心功能
- **文件选择器**：使用`ActivityResultContracts.StartActivityForResult`
- **文件读取**：通过`ContentResolver`读取文件内容
- **JSON解析**：使用Gson库解析JSON数据
- **去重逻辑**：基于URL地址进行重复检查

### 📱 权限要求
- `READ_EXTERNAL_STORAGE`：读取外部存储文件
- 文件访问权限（Android 11+）

### 🛡️ 错误处理
- 文件内容为空
- JSON格式错误
- 文件读取失败
- 权限不足

## 支持的JSON格式

### 标准格式
```json
[
  {
    "title": "链接标题（可选）",
    "url": "链接地址",
    "timestamp": 1703123456789
  }
]
```

### 字段说明
- **title**：链接显示标题（可选）
- **url**：实际链接地址（必需）
- **timestamp**：创建时间戳（可选）

### 支持的链接类型
- ✅ HTTP/HTTPS链接
- ✅ 得物深度链接（dewulink://）
- ✅ 其他自定义协议链接

## 使用场景

### 📥 批量导入
- 从其他设备导出的URL列表
- 备份的链接数据恢复
- 批量添加大量链接

### 🔄 数据同步
- 多设备间同步链接
- 团队共享链接列表
- 版本更新时的数据迁移

### 💾 备份恢复
- 定期备份链接数据
- 应用重装后恢复数据
- 意外删除后的数据恢复

## 注意事项

### ⚠️ 重要提醒
1. **文件格式**：确保JSON文件格式正确
2. **权限设置**：确保应用有文件读取权限
3. **数据备份**：导入前建议备份现有数据
4. **重复检查**：追加模式会自动去重

### 🔍 故障排除
- **无法选择文件**：检查文件管理器权限
- **导入失败**：检查JSON文件格式
- **权限错误**：重新授予存储权限
- **解析错误**：验证JSON格式正确性

## 更新日志

### v1.1.0 (新增功能)
- ✅ 添加JSON文件导入功能
- ✅ 支持替换和追加两种模式
- ✅ 自动去重处理
- ✅ 完善的错误处理机制
- ✅ 用户友好的确认对话框

现在你可以方便地导入外部JSON文件来批量管理URL链接了！
